{% extends 'base.html' %}
{% load static %}

{% block title %}Home{% endblock %}

{% block content %}
<script>
    function download_csv_file() {  
  
        //define the heading for each row of the data  
        var csv = 'first_name, last_name, internation_student, gender, email, phone, byu_id, employee_record, hire_date, pay_rate, last_pay_increase, pay_increase_amount, increase_input_date\n';   
        
        "joe,johnson,yes,male,shyrumj@gmail.com,9891913840,822802921,1,3,3,2022-11-01,15.68,2022-11-01,5.26,2022-11-08"
        
        csv += "joe,johnson,yes,male,shyrumj@gmail.com,9891913840,822802921,1,3,3,2022-11-01,15.68,2022-11-01,5.26,2022-11-08" + "\r\n"
        csv += "jane,timothy,yes,female,jane892@gmail.com,9101099111,822802921,1,3,3,2022-11-01,15.68,2022-11-01,5.26,2022-11-08" + "\r\n"
        csv += "william,spencer,yes,male,william1010@gmail.com,1293111,822802921,1,3,3,2022-11-01,15.68,2022-11-01,5.26,2022-11-08" + "\r\n"
        csv += "tom,yorg,yes,male,tom9101@gmail.com,9891913840,1235466,1,3,3,2022-11-01,15.68,2022-11-01,5.26,2022-11-08" + "\r\n"
        csv += "freddie,aldous,yes,male,freddie91012@gmail.com,182993003,822802921,1,3,3,2022-11-01,15.68,2022-11-01,5.26,2022-11-08" + "\r\n"
        csv += "tim,smith,yes,male,tim1022@gmail.com,9891913840,19293800502,1,3,3,2022-11-01,15.68,2022-11-01,5.26,2022-11-08" + "\r\n"
        csv += "betty,franklin,yes,female,betty11212@gmail.com,9891913840,128339944,1,3,3,2022-11-01,15.68,2022-11-01,5.26,2022-11-08" + "\r\n"
        csv += "becks,bees,yes,female,becks300392@gmail.com,9891913840,129340053,1,3,3,2022-11-01,15.68,2022-11-01,5.26,2022-11-08" + "\r\n"
        csv += "chad,millet,yes,male,chad231@gmail.com,9891913840,1293490032,1,3,3,2022-11-01,15.68,2022-11-01,5.26,2022-11-08" + "\r\n"
        csv += "luke,figgins,yes,male,luke1111@gmail.com,9891913840,1293004032,1,3,3,2022-11-01,15.68,2022-11-01,5.26,2022-11-08" + "\r\n"
        csv += "josh,christensen,yes,male,josh888@gmail.com,9891913840,128304030,1,3,3,2022-11-01,15.68,2022-11-01,5.26,2022-11-08" + "\r\n"
        csv += "sam,brown,yes,male,sam1223@gmail.com,9891913840,59900434,1,3,3,2022-11-01,15.68,2022-11-01,5.26,2022-11-08" + "\r\n"
        csv += "fan,marshall,yes,female,fanfan@gmail.com,9891913840,822802921,1,3,3,2022-11-01,15.68,2022-11-01,5.26,2022-11-08" + "\r\n"

        var hiddenElement = document.createElement('a');  
        hiddenElement.href = 'data:text/csv;charset=utf-8,' + encodeURI(csv);  
        hiddenElement.target = '_blank';  
          
        //provide the name for the CSV file to be downloaded  
        hiddenElement.download = 'Student Employees.csv';  
        hiddenElement.click();  
    }
    
</script>


<div class="container-fluid px-4">
    <br/>
    <br/>
    <h1 class="mt-8">BYU IS Employee Registration Portal</h1>
    <br/>
   
    <br/>
    {% comment %} <form action="{% url 'sendEmail' %}" method="post">
        {% csrf_token %}
        <input name="recipient" type="text" placeholder="Enter the recipient email">
        <input name="messageSubject" type="hidden" value="Test Email">
        <input name="messageText" type="hidden" value="This email verifies that the send email feature worked!">
        <br><br>
        <button type="submit" class="btn btn-info">Send Test Email</button>
    </form><br> {% endcomment %}
    {% comment %} <a class="btn btn-success" href="{% url 'addStudentEmployeeForm' %}">Add New Student Employee</a>
    <a class="btn btn-success" href="{% url 'searchbyuid' %}">Edit Employee by BYU ID</a> {% endcomment %}
    <div class="row ">
        {% comment %} <div class='tableauPlaceholder' id='viz1667258404049' style='width:100%; height:100%;'>
            <noscript>
                <a href='#'>
                    <img alt='Student Employee Information Summative Reports  ' src='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;IS&#47;IS405project&#47;Dashboard1&#47;1_rss.png' style='border: none' />
                </a>
            </noscript>
            <object class='tableauViz'  width="100%" height="100%" style='display:none;'>
                <param name='host_url' value='https%3A%2F%2Fpublic.tableau.com%2F' />
                <param name='embed_code_version' value='3' /> 
                <param name='site_root' value='' />
                <param name='name' value='IS405project&#47;Dashboard1' />
                <param name='tabs' value='no' /><param name='toolbar' value='yes' />
                <param name='static_image' value='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;IS&#47;IS405project&#47;Dashboard1&#47;1.png' /> 
                <param name='animate_transition' value='yes' />
                <param name='display_static_image' value='yes' />
                <param name='display_spinner' value='yes' />
                <param name='display_overlay' value='yes' />
                <param name='display_count' value='yes' />
                <param name='language' value='en-US' />
            </object>
        </div>                 {% endcomment %}
        <script type='text/javascript'>                    var divElement = document.getElementById('viz1667258404049');                    var vizElement = divElement.getElementsByTagName('object')[0];                    if ( divElement.offsetWidth > 800 ) { vizElement.style.width='1654px';vizElement.style.height='1196px';} else if ( divElement.offsetWidth > 500 ) { vizElement.style.width='1654px';vizElement.style.height='1196px';} else { vizElement.style.width='100%';vizElement.style.height='2177px';}                     var scriptElement = document.createElement('script');                    scriptElement.src = 'https://public.tableau.com/javascripts/api/viz_v1.js';                    vizElement.parentNode.insertBefore(scriptElement, vizElement);                </script>
    </div>
    <div class="container-fluid px-4">
        {% comment %} <h1 class="mt-4">Tableau Graphs</h1>
        <ol class="breadcrumb mb-4">
            <li class="breadcrumb-item active">Tableau Graphs</li>
        </ol> {% endcomment %}
        <div class="row">
                <div class='tableauPlaceholder' id='viz1667258404049' style='width:100%; height:100%;'>
                    <noscript>
                        <a href='#'>
                            <img alt='Student Employee Information Summative Reports  ' src='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;IS&#47;IS405project&#47;Dashboard1&#47;1_rss.png' style='border: none' />
                        </a>
                    </noscript>
                    <object class='tableauViz'  width="100%" height="100%" style='display:none;'>
                        <param name='host_url' value='https%3A%2F%2Fpublic.tableau.com%2F' />
                        <param name='embed_code_version' value='3' /> 
                        <param name='site_root' value='' />
                        <param name='name' value='IS405project&#47;Dashboard1' />
                        <param name='tabs' value='no' /><param name='toolbar' value='yes' />
                        <param name='static_image' value='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;IS&#47;IS405project&#47;Dashboard1&#47;1.png' /> 
                        <param name='animate_transition' value='yes' />
                        <param name='display_static_image' value='yes' />
                        <param name='display_spinner' value='yes' />
                        <param name='display_overlay' value='yes' />
                        <param name='display_count' value='yes' />
                        <param name='language' value='en-US' />
                    </object>
                </div>                
                <script type='text/javascript'>                    var divElement = document.getElementById('viz1667258404049');                    var vizElement = divElement.getElementsByTagName('object')[0];                    if ( divElement.offsetWidth > 800 ) { vizElement.style.width='1654px';vizElement.style.height='1196px';} else if ( divElement.offsetWidth > 500 ) { vizElement.style.width='1654px';vizElement.style.height='1196px';} else { vizElement.style.width='100%';vizElement.style.height='2177px';}                     var scriptElement = document.createElement('script');                    scriptElement.src = 'https://public.tableau.com/javascripts/api/viz_v1.js';                    vizElement.parentNode.insertBefore(scriptElement, vizElement);                </script>
        </div>
    </div>

    <div class="card mb-4">
        <div class="card-header">
            <i class="fas fa-table me-1"></i>
            Student Records <a class="btn btn-success" style="float:right; margin-right:4px;" href="{% url 'addStudentEmployeeForm' %}">Add New</a> <a class="btn btn-success" style="float:right; margin-right:4px;" href="{% url 'searchbyuid' %}">Edit Student by ID</a>
        </div>
        
        <div class="card-body">
            <table id="datatablesSimple">
                <thead>
                    <tr>
                        <th>More Info</th>
                        <th>Name</th>
                        <th>BYU ID</th>
                        <th>Phone Number</th>
                        <th>Email</th>
                        <th>Hire Date</th>
                        <th>Pay Rate</th>
                        <th>Work History</th>
                    </tr>
                </thead>
                <tbody>
                    {% for x in studentRecords %}
                    <tr>
                        <td>{% comment %}<a class="btn btn-dark">View/Edit</a>{% endcomment %}<a class="btn " style="background-color:#4E79A7; color: white" href="{% url 'addWorkAssignment' byuNumber=x.byu_id %}">Add Job Information</a></td>
                        <td>{{ x.first_name }} {{x.last_name}}</td>
                        <td>{{x.byu_id}}</td>
                        <td>{{x.phone}}</td>
                        <td>{{x.email}}</td>
                        <td>{{x.hire_date}}</td>
                        <td>{{x.pay_rate}}</td>
                        <td>
                            {% for assignment in x.work_assignments_list %}
                                <h6><span class="badge bg-success">{{assignment}}</span></h6>
                            {% endfor %}
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
    <div>
        <h3>Download Employee Data CSVs</h3>
        <button class="btn btn-success" onclick="download_csv_file()">Employee by Supervisor</button>
        <button class="btn btn-success" onclick="download_csv_file()">Employee by Semester</button>
        <button class="btn btn-success" onclick="download_csv_file()">All Employees</button>
    </div>

</div>

{% endblock %}